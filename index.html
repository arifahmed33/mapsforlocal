<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Riyadh Roads Map (Arabic to English)</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body, #map { height: 100%; margin: 0; padding: 0; }
  </style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/osmtogeojson@3.0.0/osmtogeojson.js"></script>

<script>
  const map = L.map('map').setView([24.7136, 46.6753], 12);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution:'&copy; OpenStreetMap contributors',
    maxZoom: 19
  }).addTo(map);

  const query = `
    [out:json][timeout:60];
    (
      way["highway"="motorway"](24.6,46.5,24.85,46.9);
      way["highway"="primary"](24.6,46.5,24.85,46.9);
      way["highway"="tertiary"](24.6,46.5,24.85,46.9);
    );
    out body;
    >;
    out skel qt;
  `;

  fetch('https://overpass-api.de/api/interpreter', {
    method: 'POST',
    body: query,
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    }
  })
  .then(response => response.json())
  .then(data => {
    const geojson = osmtogeojson(data);
    L.geoJSON(geojson, {
      style: feature => {
        const type = feature.properties.tags?.highway;
        if (type === 'motorway') return { color: '#28a745', weight: 6 };
        if (type === 'primary') return { color: '#ff0000', weight: 5 };
        if (type === 'tertiary') return { color: '#007bff', weight: 3, dashArray: '8,5' };
        return { color: '#999', weight: 1 };
      },
      onEachFeature: (feature, layer) => {
        const tags = feature.properties.tags || {};
        const en = tags['name:en'];
        const ar = tags['name'];
        let roadName = en || ar || 'Unnamed road';

        // Log if it's Arabic-only
        if (!en && ar) {
          console.log(`Arabic only: ${ar}`);
        }

        layer.bindPopup(`<strong>${roadName}</strong><br>Type: ${tags.highway}`);
      }
    }).addTo(map);
  })
  .catch(err => {
    console.error("Error fetching OSM data:", err);
  });
</script>
</body>
</html>
